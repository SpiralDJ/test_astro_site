---
import Layout from "../layouts/Layout.astro";
import { getCollection, type CollectionEntry } from "astro:content";

type Page = CollectionEntry<"pages">;

// Keep `[...slug].astro` and return a STRING for nesting (e.g. "about/team")
export async function getStaticPaths() {
  const docs = await getCollection("pages");
  return docs.map((p) => ({
    params: { slug: p.slug },  // string works for catch-all
    props: { page: p as Page },
  }));
}

const { page } = Astro.props as { page: Page };
const { Content } = await page.render();   // <- no `data` here
const title = page.data.title ?? page.slug.split("/").at(-1); // fallback just in case
---
<Layout title={title}>
  <Content />
</Layout>
